<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë””ì—‘ì…€ ì»¤ìŠ¤í…€ ë°ì¹¼ ë””ìì¸ í”„ë¦¬ë·° I</title><br>

  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/moonspam/NanumSquareNeo@1.0/nanumsquareneo.css">

  <style>
    /* =========================================
       1. í°íŠ¸ ì •ì˜
       ========================================= */
    @font-face {
      font-family: 'TmonMonsori';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/TmonMonsori.woff') format('woff');
      font-weight: normal; font-style: normal;
    }
    @font-face {
      font-family: 'BMDOHYEON';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_one@1.0/BMDOHYEON.woff') format('woff');
      font-weight: normal; font-style: normal;
    }
    @font-face {
      font-family: 'BMJUA';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_one@1.0/BMJUA.woff') format('woff');
      font-weight: normal; font-style: normal;
    }
    @font-face {
      font-family: 'BMYEONSUNG';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_one@1.0/BMYEONSUNG.woff') format('woff');
      font-weight: normal; font-style: normal;
    }
    @font-face {
      font-family: 'GangwonEdu_OTFBoldA';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2201-2@1.0/GangwonEdu_OTFBoldA.woff') format('woff');
      font-weight: normal; font-style: normal;
    }
    @font-face {
      font-family: 'MaplestoryOTFLight';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_20-04@2.1/MaplestoryOTFLight.woff') format('woff');
      font-weight: normal; font-style: normal;
    }
    @font-face {
      font-family: 'MaruBuri-Regular';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_20-10-21@1.0/MaruBuri-Regular.woff') format('woff');
      font-weight: normal; font-style: normal;
    }
    @font-face {
      font-family: 'Cafe24Supermagic-Bold-v1.0';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2307-2@1.0/Cafe24Supermagic-Bold-v1.0.woff2') format('woff2');
      font-weight: 700; font-style: normal;
    }
    @font-face {
      font-family: 'Yeonji';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/naverfont_11@1.0/Yunji.woff') format('woff');
      font-weight: normal; font-style: normal;
    }
    @font-face {
      font-family: 'BMEULJIRO';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_twelve@1.0/BMEULJIRO.woff') format('woff');
      font-weight: normal; font-style: normal;
    }
    @font-face {
      font-family: 'NeoDunggeunmoPro-Regular';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2302@1.0/NeoDunggeunmoPro-Regular.woff2') format('woff2');
      font-weight: normal; font-style: normal;
    }
    @font-face {
      font-family: 'ChosunGs';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_20-04@1.0/ChosunGs.woff') format('woff');
      font-weight: normal; font-style: normal;
    }
    @font-face {
      font-family: 'Cafe24SsurroundAir';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2105_2@1.0/Cafe24SsurroundAir.woff') format('woff');
      font-weight: normal; font-style: normal;
    }

    /* =========================================
       2. ìŠ¤íƒ€ì¼ ì •ì˜
       ========================================= */
    body {
      font-family: 'NanumSquareNeo', -apple-system, sans-serif;
      max-width: 900px;
      margin: 10px auto; 40px
      padding: 0 16px;
      line-height: 1.6;
      font-size: 15px;
      color: #333;
    }

    h1 { margin-bottom: 4px; font-size: 24px; font-weight: 700; }
    
    label { display: block; margin-top: 16px; font-weight: 600; font-size: 14px; }

    textarea, select {
      width: 100%; box-sizing: border-box; padding: 8px 10px;
      margin-top: 6px; border: 1px solid #ddd; border-radius: 6px;
      font-family: inherit; font-size: 14px;
    }

    /* ğŸ”¥ ë¬¸êµ¬ì…ë ¥ì¹¸ 1ì¤„ë§Œ ë³´ì´ê²Œ + ìŠ¤í¬ë¡¤ ìˆ¨ê¹€ */
    textarea {
      resize: none;
      height: 32px;
      min-height: 32px;
      line-height: 1.4;
      overflow: hidden;
    }

    .preview-box {
      margin-top: 14px; padding: 10px; border-radius: 8px;
      border: 1px dashed #bbb; background: #fafafa;
      width: 100%; max-width: 900px; box-sizing: border-box;
    }

    .car-wrap { position: relative; width: 100%; max-width: 900px; }
    #car-img { width: 100%; display: block; }

    .window-overlay {
      position: absolute; left: 0; top: 0; width: 100%; height: 100%;
      display: flex; justify-content: center; align-items: center;
      pointer-events: none; background: transparent; overflow: hidden;
      box-sizing: border-box;
    }

    .align-group {
      position: relative;
      display: inline-flex;
      flex-direction: column;   /* â¬… ì¤„ ë‹¨ìœ„ë¡œ ìœ„â†’ì•„ë˜ */
      align-items: flex-start;
    }

    .line-row {
      display: inline-flex;
      flex-direction: row;      /* â¬… (í…ìŠ¤íŠ¸, ê°€ì´ë“œ) ê°€ë¡œ ë‚˜ì—´ */
      align-items: flex-start;
    }

    .preview-line {
      white-space: nowrap;
      text-align: left;
      color: #ffffff;
      text-shadow: 0 0 3px rgba(0,0,0,0.5);
      line-height: 1;
    }

    /* ===== ê°€ì´ë“œë¼ì¸ (í…ìŠ¤íŠ¸ + ê´„í˜¸ í†µí•© ë²„ì „) ===== */

    .size-ruler-overlay {
      display: inline-flex;
      align-items: center;
      width: auto;
      margin-left: 8px;
      margin-right: 0;
      position: relative;
      box-sizing: border-box;
    }

    .size-ruler-inner {
      display: none;
      position: relative;
      width: 100%;
      height: 100%;
    }
    .size-ruler-line-vertical,
    .size-ruler-end {
      display: none;
    }

    .size-ruler-display {
      display: inline-flex;
      align-items: center;
      font-family: 'NanumSquareNeo', sans-serif;
      color: #FFE87C;
      font-size: 11px;
      white-space: nowrap;
      opacity: 0.2; 
    }

    .size-bracket {
      display: inline-block;
      font-weight: 300;
      font-size: 1em;
      margin-left: 0;
      margin-right: -0.15em;
      line-height: 1;
      color: #FFE87C;
      transform: scaleX(0.8);
      transform-origin: center;
    }

    .size-arrow {
      display: inline-flex;
      align-items: center;
      margin-right: 6px;
      flex-direction: row-reverse;
    }
    .size-arrow-line {
      display: block;
      width: 40px;
      height: 1px;
      background: #FFE87C;
    }
    .size-arrow-head {
      width: 0;
      height: 0;
      border-top: 2px solid transparent;
      border-bottom: 3px solid transparent;
      border-right: 12px solid #FFE87C;
      margin-right: -1px;
    }

    .size-ruler-label {
      font-size: 1em;
      color: #FFE87C;
      white-space: nowrap;
      background: transparent;
      padding: 0 4px 0 0;
    }

    .size-box {
      margin-top: 10px; padding: 10px 12px; border-radius: 8px;
      border: 1px solid #e0e0e0; background: #ffffff;
      font-size: 13px; color: #333; line-height: 1.5;
    }
    .size-note, .preview-note { font-size: 12px; color: #777; margin-top: 6px; }

    #measure-span {
      position: absolute; visibility: hidden; left: -9999px; top: -9999px;
      white-space: pre-line;
      line-height: 1;
    }

    option[value="font1"]  { font-family: 'TmonMonsori', sans-serif; }
    option[value="font2"]  { font-family: 'BMDOHYEON',   sans-serif; }
    option[value="font3"]  { font-family: 'BMJUA',       sans-serif; }
    option[value="font4"]  { font-family: 'BMYEONSUNG',  sans-serif; }
    option[value="font5"]  { font-family: 'GangwonEdu_OTFBoldA', sans-serif; }
    option[value="font6"]  { font-family: 'MaplestoryOTFLight',  sans-serif; }
    option[value="font7"]  { font-family: 'MaruBuri-Regular',    serif; }
    option[value="font8"]  { font-family: 'Cafe24Supermagic-Bold-v1.0', sans-serif; }
    option[value="font9"]  { font-family: 'Yeonji', sans-serif; font-weight: bold; }
    option[value="font10"] { font-family: 'NanumSquareNeo', sans-serif; font-weight: 800; }
    option[value="font11"] { font-family: 'BMEULJIRO',     sans-serif; }
    option[value="font13"] { font-family: 'NeoDunggeunmoPro-Regular', monospace; }
    option[value="font14"] { font-family: 'ChosunGs',      serif; font-weight: 600; }
    option[value="font15"] { font-family: 'Cafe24SsurroundAir', sans-serif; font-weight: 700; }

  </style>
</head>
<body>
  <h1>ë””ì—‘ì…€ ì»¤ìŠ¤í…€ ë°ì¹¼ ë””ìì¸ í”„ë¦¬ë·° I</h1>

  <span style="display:block; margin:5px 0 30px; font-weight:400; font-size:15px; color:#666;">
  ìŠ¤í‹°ì»¤ì˜ ë””ìì¸ê³¼ ëŒ€ëµì ì¸ í¬ê¸°ë¥¼ ë¯¸ë¦¬ ì‚´í´ë³¼ ìˆ˜ ìˆëŠ” í˜ì´ì§€ì…ë‹ˆë‹¤.
</span>

  <!-- ì…ë ¥ì¹¸ -->
  <label>
    ë¬¸êµ¬ì…ë ¥
    <span style="font-weight:400; font-size:12px; color:#666;">
      (ì´ 15ê¸€ìê¹Œì§€ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤)
    </span>
    <textarea id="text-input"   maxlength="15" placeholder="ì²« ë²ˆì§¸ ë¬¸êµ¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
    <textarea id="text-input-2" maxlength="15" placeholder="ë‘ ë²ˆì§¸ ë¬¸êµ¬ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒ)"></textarea>
    <textarea id="text-input-3" maxlength="15" placeholder="ì„¸ ë²ˆì§¸ ë¬¸êµ¬ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒ)"></textarea>
  </label>

  <label>
    ì‚¬ì´ì¦ˆ
    <select id="width-select">
      <option value="3">S (ì„¸ë¡œ 3cm)</option>
      <option value="4">ì†Œ (ì„¸ë¡œ 4cm)</option>
      <option value="5">ì¤‘ (ì„¸ë¡œ 5cm)</option>
      <option value="6">ëŒ€ (ì„¸ë¡œ 6cm)</option>
      <option value="" disabled>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</option>
      <option value="10">*ëŒ€í˜•ì‚¬ì´ì¦ˆ10 (ì„¸ë¡œ 10cm)</option>  
      <option value="12">*ëŒ€í˜•ì‚¬ì´ì¦ˆ12 (ì„¸ë¡œ 12cm)</option>
      <option value="15">*ëŒ€í˜•ì‚¬ì´ì¦ˆ15 (ì„¸ë¡œ 15cm)</option>       
    </select>
  </label>

  <label>
    ê¸€ì”¨ì²´
    <select id="font-select">
      <option value="font1">1ë²ˆ ê¸€ì”¨ì²´ - ê°€ë‚˜ë‹¤ë¼ ABCY abcy 1234</option>
      <option value="font2">2ë²ˆ ê¸€ì”¨ì²´ - ê°€ë‚˜ë‹¤ë¼ ABCY abcy 1234</option>
      <option value="font3">3ë²ˆ ê¸€ì”¨ì²´ - ê°€ë‚˜ë‹¤ë¼ ABCY abcy 1234</option>
      <option value="font4">4ë²ˆ ê¸€ì”¨ì²´ - ê°€ë‚˜ë‹¤ë¼ ABCY abcy 1234</option>
      <option value="font5">5ë²ˆ ê¸€ì”¨ì²´ - ê°€ë‚˜ë‹¤ë¼ ABCY abcy 1234</option>
      <option value="font6">6ë²ˆ ê¸€ì”¨ì²´ - ê°€ë‚˜ë‹¤ë¼ ABCY abcy 1234</option>
      <option value="font7">7ë²ˆ ê¸€ì”¨ì²´ - ê°€ë‚˜ë‹¤ë¼ ABCY abcy 1234</option>
      <option value="font8">8ë²ˆ ê¸€ì”¨ì²´ - ê°€ë‚˜ë‹¤ë¼ ABCY abcy 1234</option>
      <option value="font9">9ë²ˆ ê¸€ì”¨ì²´ - ê°€ë‚˜ë‹¤ë¼ ABCY abcy 1234</option>
      <option value="font10">10ë²ˆ ê¸€ì”¨ì²´ - ê°€ë‚˜ë‹¤ë¼ ABCY abcy 1234</option>
      <option value="font11">11ë²ˆ ê¸€ì”¨ì²´ - ê°€ë‚˜ë‹¤ë¼ ABCY abcy 1234</option>
      <option value="font13">13ë²ˆ ê¸€ì”¨ì²´ - ê°€ë‚˜ë‹¤ë¼ ABCY abcy 1234</option>
      <option value="font14">14ë²ˆ ê¸€ì”¨ì²´ - ê°€ë‚˜ë‹¤ë¼ ABCY abcy 1234</option>
      <option value="font15">15ë²ˆ ê¸€ì”¨ì²´ - ê°€ë‚˜ë‹¤ë¼ ABCY abcy 1234</option>
    </select>
  </label>

  <label>
    ì •ë ¬
    <select id="align-select">
      <option value="left" selected>ì¢Œì¸¡ì •ë ¬</option>
      <option value="right">ìš°ì¸¡ì •ë ¬</option>
      <option value="center">ì¤‘ì•™ì •ë ¬</option>
    </select>
  </label>

  <div id="preview-box" class="preview-box">
    <div class="car-wrap">
      <img id="car-img" src="ì˜ë Œí†  ì„¸ë¡œ900.jpg" alt="ì°¨ëŸ‰ ì´ë¯¸ì§€">

      <div id="window-overlay" class="window-overlay">
        <div id="align-group" class="align-group">

          <!-- 1ì¤„ -->
          <div class="line-row" id="line-row-1">
            <div class="preview-line" id="preview-line-1">ë¬¸êµ¬ë¥¼ ì…ë ¥í•˜ë©´ ë¯¸ë¦¬ë³´ê¸°ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>
            <div class="size-ruler-overlay">
              <div class="size-ruler-inner">
                <div class="size-ruler-line-vertical"></div>
                <div class="size-ruler-end top"></div>
                <div class="size-ruler-end bottom"></div>
              </div>
              <div class="size-ruler-display">
                <span class="size-bracket">)</span>
                <span class="size-arrow">
                  <span class="size-arrow-line"></span>
                  <span class="size-arrow-head"></span>
                </span>
                <span class="size-ruler-label">ì„¸ë¡œ 3cm</span>
              </div>
            </div>
          </div>

          <!-- 2ì¤„ -->
          <div class="line-row" id="line-row-2">
            <div class="preview-line" id="preview-line-2"></div>
            <div class="size-ruler-overlay">
              <div class="size-ruler-inner">
                <div class="size-ruler-line-vertical"></div>
                <div class="size-ruler-end top"></div>
                <div class="size-ruler-end bottom"></div>
              </div>
              <div class="size-ruler-display">
                <span class="size-bracket">)</span>
                <span class="size-arrow">
                  <span class="size-arrow-line"></span>
                  <span class="size-arrow-head"></span>
                </span>
                <span class="size-ruler-label">ì„¸ë¡œ 3cm</span>
              </div>
            </div>
          </div>

          <!-- 3ì¤„ -->
          <div class="line-row" id="line-row-3">
            <div class="preview-line" id="preview-line-3"></div>
            <div class="size-ruler-overlay">
              <div class="size-ruler-inner">
                <div class="size-ruler-line-vertical"></div>
                <div class="size-ruler-end top"></div>
                <div class="size-ruler-end bottom"></div>
              </div>
              <div class="size-ruler-display">
                <span class="size-bracket">)</span>
                <span class="size-arrow">
                  <span class="size-arrow-line"></span>
                  <span class="size-arrow-head"></span>
                </span>
                <span class="size-ruler-label">ì„¸ë¡œ 3cm</span>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

  <div class="preview-note">
    ì˜ˆì‹œì°¨ëŸ‰ : ê¸°ì•„ ì˜ë Œí†  MQ4 PE<br>
    *í™”ë©´ì—ì„œ ë³´ì´ëŠ” ì°¨ëŸ‰ê³¼ ì œí’ˆì˜ ë¹„ìœ¨ì€ ì‹¤ì œì™€ ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ, ì°¸ê³ ìš©ìœ¼ë¡œ í™•ì¸í•´ ì£¼ì„¸ìš”.
  </div>

  <div id="size-box" class="size-box">
   

    <!-- â˜…ì¤„ë³„ ì‚¬ì´ì¦ˆ í‘œì‹œ -->
    <div id="size-line1">1ë²ˆì§¸ ì¤„ : -</div>
    <div id="size-line2">2ë²ˆì§¸ ì¤„ : -</div>
    <div id="size-line3">3ë²ˆì§¸ ì¤„ : -</div>
    <!-- â˜…ì¶”ê°€ ë -->
    <div class="size-note">

    </div>

 <div id="size-width">ì „ì²´ì‚¬ì´ì¦ˆ : -</div>
    <div id="size-height"></div>
 <div class="size-note">

*ê°€ë¡œì‚¬ì´ì¦ˆëŠ” ì¶”ì •ì¹˜ë¡œ ê³„ì‚°ëœ ìˆ˜ì¹˜ì´ë¯€ë¡œ ì‹¤ì œí¬ê¸°ì™€ ë‹¤ì†Œ ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ë²”ìœ„ : Â± 0.5~10cm)<BR>
*ì „ì²´ì‚¬ì´ì¦ˆì˜ ì„¸ë¡œì‚¬ì´ì¦ˆëŠ” ìœ ì €ì˜ ë¶€ì°©í˜•íƒœì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    </div>
  </div>

  <span id="measure-span"></span>

<script>
  const textInput1      = document.getElementById("text-input");
  const textInput2      = document.getElementById("text-input-2");
  const textInput3      = document.getElementById("text-input-3");
  const fontSelect      = document.getElementById("font-select");
  const widthSelect     = document.getElementById("width-select");
  const alignSelect     = document.getElementById("align-select");
  const measureSpan     = document.getElementById("measure-span");
  const carImg          = document.getElementById("car-img");
  const alignGroup      = document.getElementById("align-group");
  const windowOverlay   = document.getElementById("window-overlay");
  const sizeBoxWidth    = document.getElementById("size-width");
  const sizeBoxHeight   = document.getElementById("size-height");

  const previewLines    = document.querySelectorAll(".preview-line");
  const lineRows        = document.querySelectorAll(".line-row");
  const rulerOverlays   = document.querySelectorAll(".size-ruler-overlay");
  const rulerLabels     = document.querySelectorAll(".size-ruler-label");
  const brackets        = document.querySelectorAll(".size-bracket");
  const arrows          = document.querySelectorAll(".size-arrow");
  const arrowHeads      = document.querySelectorAll(".size-arrow-head");

  const IMAGE_REAL_HEIGHT_CM = 90; 
  const MAX_LEN       = 15;
  const LINE_HEIGHT   = 1.2;

  const IMG_ORIG_W   = 1900; 
  const LEFT_TEXT_X  = 348;
  const RIGHT_TEXT_X = 1516;

  // â˜…ì¤„ë³„ ì‚¬ì´ì¦ˆ ìš”ì†Œ
  const sizeLine1 = document.getElementById("size-line1");
  const sizeLine2 = document.getElementById("size-line2");
  const sizeLine3 = document.getElementById("size-line3");
  const sizeLineElems = [sizeLine1, sizeLine2, sizeLine3];
  // â˜…ë

  function getSelectedFontConfig() {
    const val = fontSelect.value;
    let family = "'NanumSquareNeo', sans-serif";
    let weight = "normal";

    if (val === "font1")  family = "'TmonMonsori', sans-serif";
    if (val === "font2")  family = "'BMDOHYEON', sans-serif";
    if (val === "font3")  family = "'BMJUA', sans-serif";
    if (val === "font4")  family = "'BMYEONSUNG', sans-serif";
    if (val === "font5")  family = "'GangwonEdu_OTFBoldA', sans-serif";
    if (val === "font6")  family = "'MaplestoryOTFLight', sans-serif";
    if (val === "font7")  { family = "'MaruBuri-Regular', serif"; weight = "bold"; }
    if (val === "font8")  { family = "'Cafe24Supermagic-Bold-v1.0', sans-serif"; weight = "700"; }
    if (val === "font9")  { family = "'Yeonji', sans-serif"; weight = "bold"; }
    if (val === "font10") { family = "'NanumSquareNeo', sans-serif"; weight = "800"; }
    if (val === "font11") family = "'BMEULJIRO', sans-serif";
    if (val === "font13") family = "'NeoDunggeunmoPro-Regular', monospace";
    if (val === "font14") { family = "'ChosunGs', serif"; weight = "600"; }
    if (val === "font15") { family = "'Cafe24SsurroundAir', sans-serif"; weight = "700"; }

    return { family, weight };
  }

  function applyRulerLabelPosition(align) {
    rulerLabels.forEach(lbl => {
      lbl.style.textAlign = (align === 'right') ? 'right' : 'left';
    });
  }

  function recompute() {
    // 3ê°œ ì…ë ¥ì¹¸ì—ì„œ ê°ê° í…ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸° + 15ì ì œí•œ ìœ ì§€
    let r1 = textInput1.value || "";
    let r2 = textInput2.value || "";
    let r3 = textInput3.value || "";

    if (r1.length > MAX_LEN) {
      r1 = r1.substring(0, MAX_LEN);
      textInput1.value = r1;
    }
    if (r2.length > MAX_LEN) {
      r2 = r2.substring(0, MAX_LEN);
      textInput2.value = r2;
    }
    if (r3.length > MAX_LEN) {
      r3 = r3.substring(0, MAX_LEN);
      textInput3.value = r3;
    }

    const lines = [];
    if (r1.trim().length > 0) lines.push(r1);
    if (r2.trim().length > 0) lines.push(r2);
    if (r3.trim().length > 0) lines.push(r3);

    const processed = lines.join("\n");
    const pureText  = processed;

    const { family, weight } = getSelectedFontConfig();

    fontSelect.style.fontFamily = family;
    fontSelect.style.fontWeight = weight;

    previewLines.forEach(line => {
      line.style.fontFamily = family;
      line.style.fontWeight = weight;
      line.style.lineHeight = LINE_HEIGHT;
      line.style.whiteSpace = "nowrap";
    });

    measureSpan.style.fontFamily = family;
    measureSpan.style.fontWeight = weight;
    measureSpan.style.lineHeight = "1";
    measureSpan.style.whiteSpace = "pre-line";

    const carRect = carImg.getBoundingClientRect();
    const carH = carRect.height;
    const carW = carRect.width;
    if (!carH || !carW) return;

    const selCmRaw = widthSelect.value;
    const selCm = parseFloat(selCmRaw) || 0;
    const targetHeightPx = selCm ? (carH * (selCm / IMAGE_REAL_HEIGHT_CM)) : 0;

    const align = alignSelect.value;

    // ê¸°ë³¸ ì •ë ¬ ê¸°ì¤€ ì„¸íŒ…
    let offsetXBase = 0;
    const baseOffsetY = -20;   // ê¸°ë³¸ ìœ„ì¹˜
    let offsetY = baseOffsetY; // ë‚˜ì¤‘ì— ì¤„ ìˆ˜ì— ë”°ë¼ ì¡°ì •í•  ê°’
    const scaleX = carW / IMG_ORIG_W;

    const EXTRA_LEFT_SHIFT = 18;

    if (align === 'left') {
      windowOverlay.style.justifyContent = 'flex-start';
      alignGroup.style.alignItems = 'flex-start';

      previewLines.forEach(line => line.style.textAlign = 'left');

      offsetXBase = LEFT_TEXT_X * scaleX + EXTRA_LEFT_SHIFT;

      lineRows.forEach(row => {
        const textEl    = row.querySelector(".preview-line");
        const overlayEl = row.querySelector(".size-ruler-overlay");
        if (textEl && overlayEl) {
          textEl.style.order    = 1;
          overlayEl.style.order = 2;
        }
      });

      brackets.forEach(b => {
        b.textContent = ')';
        b.style.order = 1;
      });
      arrows.forEach(a => {
        a.style.order = 2;
        a.style.flexDirection = 'row-reverse';
      });
      arrowHeads.forEach(h => {
        h.style.borderRight = '12px solid #FFE87C';
        h.style.borderLeft  = '0';
      });
      rulerLabels.forEach(l => {
        l.style.order = 3;
      });

    } else if (align === 'right') {
      windowOverlay.style.justifyContent = 'flex-end';
      alignGroup.style.alignItems = 'flex-end';

      previewLines.forEach(line => line.style.textAlign = 'right');

      const scaledRightX = RIGHT_TEXT_X * scaleX;
      offsetXBase = scaledRightX - carW;

      lineRows.forEach(row => {
        const textEl    = row.querySelector(".preview-line");
        const overlayEl = row.querySelector(".size-ruler-overlay");
        if (textEl && overlayEl) {
          overlayEl.style.order = 1;
          textEl.style.order    = 2;
        }
      });

      brackets.forEach(b => {
        b.textContent = '(';
        b.style.order = 3;
      });
      rulerLabels.forEach(l => {
        l.style.order = 1;
      });
      arrows.forEach(a => {
        a.style.order = 2;
        a.style.flexDirection = 'row';
      });
      arrowHeads.forEach(h => {
        h.style.borderLeft  = '12px solid #FFE87C';
        h.style.borderRight = '0';
      });

    } else { // center
      windowOverlay.style.justifyContent = 'center';
      alignGroup.style.alignItems = 'center';

      previewLines.forEach(line => line.style.textAlign = 'center');

      offsetXBase = 0;

      lineRows.forEach(row => {
        const textEl    = row.querySelector(".preview-line");
        const overlayEl = row.querySelector(".size-ruler-overlay");
        if (textEl && overlayEl) {
          textEl.style.order    = 1;
          overlayEl.style.order = 2;
        }
      });

      brackets.forEach(b => {
        b.textContent = ')';
        b.style.order = 1;
      });
      arrows.forEach(a => {
        a.style.order = 2;
        a.style.flexDirection = 'row-reverse';
      });
      rulerLabels.forEach(l => {
        l.style.order = 3;
      });
      arrowHeads.forEach(h => {
        h.style.borderRight = '12px solid #FFE87C';
        h.style.borderLeft  = '0';
      });
    }

    applyRulerLabelPosition(align);

    // í…ìŠ¤íŠ¸ ì—†ì„ ë•Œ (í”Œë ˆì´ìŠ¤í™€ë”)
    if (!pureText || pureText.length === 0) {
      previewLines.forEach(line => {
        line.style.fontSize   = "14px";
        line.style.fontFamily = "'NanumSquareNeo', sans-serif";
        line.style.fontWeight = "400";
      });

      if (previewLines[0]) previewLines[0].textContent = "ë¬¸êµ¬ë¥¼ ì…ë ¥í•˜ë©´";
      if (previewLines[1]) previewLines[1].textContent = "ë¯¸ë¦¬ë³´ê¸°ê°€ í‘œì‹œë©ë‹ˆë‹¤";
      if (previewLines[2]) previewLines[2].textContent = "";

      lineRows.forEach((row, idx) => {
        row.style.display = (idx <= 1 ? "flex" : "none");
      });

      rulerOverlays.forEach(ov => {
        ov.style.display = "none";
      });

      // ì „ì²´ì‚¬ì´ì¦ˆ ì´ˆê¸°í™”
      sizeBoxWidth.textContent  = "ì „ì²´ì‚¬ì´ì¦ˆ : -";
      sizeBoxHeight.textContent = "";

      // ì¤„ë³„ ì‚¬ì´ì¦ˆ ì´ˆê¸°í™”
      sizeLineElems.forEach((el, idx) => {
        if (el) el.textContent = `${idx+1}ë²ˆì§¸ ì¤„ : -`;
      });

      alignGroup.style.transform = `translate(${offsetXBase}px, ${baseOffsetY}px)`;
      return;
    }

    // í…ìŠ¤íŠ¸ ìˆì„ ë•Œ: ì¤„ë³„ í‘œì‹œ/ìˆ¨ê¹€
    lineRows.forEach((row, idx) => {
      const textLine  = lines[idx] || "";
      const textEl    = row.querySelector(".preview-line");
      const overlayEl = row.querySelector(".size-ruler-overlay");
      if (textLine) {
        row.style.display = "flex";
        if (textEl)    textEl.textContent = textLine;
        if (overlayEl) overlayEl.style.display = "inline-flex";
      } else {
        row.style.display = "none";
        if (textEl)    textEl.textContent = "";
        if (overlayEl) overlayEl.style.display = "none";
      }
    });

    // âœ… í°íŠ¸ í¬ê¸°ëŠ” "1ë²ˆì§¸ ì¤„" ë†’ì´ë¥¼ ì„ íƒí•œ ì„¸ë¡œ cmë¡œ ë§ì¶˜ë‹¤
    const baseLineText = lines[0] || processed;

    const finalSize = findFontSizeByHeight(
      baseLineText,
      family,
      weight,
      targetHeightPx || 1
    );

    previewLines.forEach(line => {
      line.style.fontSize = finalSize + "px";
    });

    // ì‹¤ì œ ì „ì²´ ë¸”ë¡ í¬ê¸° ì¸¡ì •ìš© (ì¤„ê°„ê²© í¬í•¨)
    measureSpan.style.fontSize   = finalSize + "px";
    measureSpan.style.lineHeight = LINE_HEIGHT;
    measureSpan.style.whiteSpace = "pre-line";
    measureSpan.textContent      = processed;
    const rect = measureSpan.getBoundingClientRect();

    const cmPerPx = IMAGE_REAL_HEIGHT_CM / carH;
    const realW = rect.width * cmPerPx;
    const realH = rect.height * cmPerPx;  // ì—¬ëŸ¬ ì¤„ + ì¤„ê°„ê²© í¬í•¨

    // ğŸ”¥ ì „ì²´ì‚¬ì´ì¦ˆ ê³„ì‚°
    let totalWidthCm  = realW;
    let totalHeightCm;

    if (lines.length <= 1) {
      // í•œ ì¤„ì¼ ë•Œ: ì„¸ë¡œëŠ” ì„ íƒí•œ cmê°€ ìˆìœ¼ë©´ ê·¸ê±¸ ì‚¬ìš© (ì—†ìœ¼ë©´ ì‹¤ì œê°’)
      totalHeightCm = selCm || realH;
    } else {
      // ë‘ ì¤„ ì´ìƒ: ì „ì²´ ë¸”ë¡(ì¤„ê°„ê²© í¬í•¨) ì‹¤ì œ ë†’ì´ ì‚¬ìš©
      totalHeightCm = realH;
    }

    sizeBoxWidth.textContent  = `ì „ì²´ì‚¬ì´ì¦ˆ : ê°€ë¡œ ${totalWidthCm.toFixed(1)} cm / ì„¸ë¡œ ${totalHeightCm.toFixed(1)} cm`;
    sizeBoxHeight.textContent = "";

    // â˜…ì¤„ë³„ ì‚¬ì´ì¦ˆ ê³„ì‚°
    sizeLineElems.forEach((el, idx) => {
      if (!el) return;
      const textLine = lines[idx] || "";
      if (!textLine) {
        el.textContent = `${idx+1}ë²ˆì§¸ ì¤„ : -`;
        return;
      }
      // í•´ë‹¹ ì¤„ë§Œ ì¸¡ì •
      measureSpan.style.fontSize   = finalSize + "px";
      measureSpan.style.fontFamily = family;
      measureSpan.style.fontWeight = weight;
      measureSpan.style.lineHeight = "1";
      measureSpan.style.whiteSpace = "nowrap";
      measureSpan.textContent      = textLine;
      const lineRect = measureSpan.getBoundingClientRect();
      const lineWcm = lineRect.width * cmPerPx;
      const lineHcm = selCm || (lineRect.height * cmPerPx);
      el.textContent = `${idx+1}ë²ˆì§¸ ì¤„ : ê°€ë¡œ ${lineWcm.toFixed(1)} cm / ì„¸ë¡œ ${lineHcm.toFixed(1)} cm`;
    });
    // â˜…ë

    brackets.forEach(b => {
      b.style.fontSize = `${finalSize}px`;
    });

    const spacePx = finalSize * 0.25;

    rulerOverlays.forEach((ov, idx) => {
      const lineText = lines[idx] || "";
      if (!lineText) return;
      if (align === 'right') {
        ov.style.marginRight = `${spacePx}px`;
        ov.style.marginLeft  = `0px`;
      } else {
        ov.style.marginLeft  = `${spacePx}px`;
        ov.style.marginRight = `0px`;
      }
    });

    const labelText = selCm
      ? `ì„¸ë¡œ ${selCm}cm`
      : `ì„¸ë¡œ - cm`;
    rulerLabels.forEach(l => {
      l.textContent = labelText;
    });

    let finalOffsetX = offsetXBase;
    if (align === 'center') {
      const firstOverlay = rulerOverlays[0];
      if (firstOverlay) {
        const rulerRect = firstOverlay.getBoundingClientRect();
        const rulerW = rulerRect.width || 0;
        const adjust = (spacePx + rulerW) / 2;
        finalOffsetX = offsetXBase + adjust;
      }
    }

    // ğŸ”¥ ì—¬ê¸°ì„œ "ì¤„ ê°œìˆ˜"ì— ë”°ë¼ ì „ì²´ë¥¼ ìœ„ë¡œ ì˜¬ë ¤ì¤€ë‹¤
    if (lines.length >= 2) {
      // ì¤„ì´ ë§ì„ìˆ˜ë¡ ì¡°ê¸ˆ ë” ìœ„ë¡œ
      const extraOffsetY = -finalSize * 0.5 * (lines.length - 1);
      offsetY = baseOffsetY + extraOffsetY;
    } else {
      offsetY = baseOffsetY;
    }

    alignGroup.style.transform = `translate(${finalOffsetX}px, ${offsetY}px)`;
  }

  function findFontSizeByHeight(text, family, weight, targetHeight) {
    if (!targetHeight) return 10;

    let low = 1, high = 500, best = 10;

    for (let i = 0; i < 20; i++) {
      const mid = (low + high) / 2;
      measureSpan.style.fontSize   = mid + "px";
      measureSpan.style.fontFamily = family;
      measureSpan.style.fontWeight = weight;
      measureSpan.style.lineHeight = "1";
      measureSpan.textContent      = text;

      const h = measureSpan.getBoundingClientRect().height;
      if (h > targetHeight) {
        high = mid;
      } else {
        best = mid;
        low = mid;
      }
    }
    return best;
  }

  // 3ê°œ ì…ë ¥ì¹¸ ëª¨ë‘ ì—”í„° ë°©ì§€ + ì…ë ¥ ì‹œ ì¬ê³„ì‚°
  [textInput1, textInput2, textInput3].forEach((el) => {
    el.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();
      }
    });
    el.addEventListener("input", recompute);
  });

  fontSelect.addEventListener("change", recompute);
  widthSelect.addEventListener("change", recompute);
  alignSelect.addEventListener("change", recompute);
  window.addEventListener("resize",    recompute);
  carImg.addEventListener("load",      recompute);
  window.onload = recompute;
</script>

</body>
</html>
